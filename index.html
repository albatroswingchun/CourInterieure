<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>L'Eveil du Dragon</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, maximum-scale=5.0">
  <style>
    html, body {
      margin: 0;
      padding: 0;
      background: #000;
      height: 100vh;
      width: 100vw;
      overflow: hidden;
      font-family: sans-serif;
    }

    #container {
      overflow-y: auto;
      overflow-x: hidden;
      height: 100vh;
      width: 100vw;
      position: relative;
    }

    .imageWrapper {
      position: relative;
      width: 100%;
    }

    .imageWrapper img {
      width: 100%;
      display: block;
    }

    .zone {
      position: absolute;
      background-color: transparent;
      cursor: pointer;
      z-index: 2;
    }

    .zone:hover {
      box-shadow: 0 0 20px 10px rgba(255, 255, 0, 0.4);
      border-radius: 8px;
    }

    .fixedBtn {
      position: fixed;
      width: 60px;
      height: 60px;
      border-radius: 50%;
      overflow: hidden;
      box-shadow: 0 0 10px rgba(255, 255, 255, 0.8);
      border: 2px solid black;
      cursor: pointer;
      z-index: 10;
      background: black;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .fixedBtn img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    #fullscreenBtn {
      position: fixed;
      top: 10px;
      right: 10px;
      z-index: 20;
      background: rgba(0, 0, 0, 0.7);
      border: 2px solid white;
      padding: 6px 12px;
      color: white;
      font-size: 13px;
      border-radius: 8px;
      cursor: pointer;
    }
  </style>
</head>

<body>
  <div id="fullscreenBtn">Plein écran</div>

  <div id="container">
    <div class="imageWrapper">
      <img id="mainImage" src="https://i.imgur.com/AG68Kpz.png" alt="Visuel principal" />
    </div>
  </div>

  <div id="logoBtn" class="fixedBtn" style="bottom: 95px; right: 20px;">
    <img src="https://i.imgur.com/uGnH5XI.png" alt="Logo Albatros">
  </div>

  <div id="secondBtn" class="fixedBtn" style="bottom: 20px; right: 20px;">
    <img src="https://i.imgur.com/ayNer7u.png" alt="Règles">
  </div>

  <div id="noteBtn" class="fixedBtn" style="bottom: 160px; right: 20px;">
    <img src="https://i.imgur.com/gRmhrKq.png" alt="Bloc-note">
  </div>

  <script>
    const salles = {
      montagne: {
        image: "https://i.imgur.com/AG68Kpz.png",
        zones: [
          { class: "porte1", top: "40%", left: "9%", width: "20%", height: "33%", action: () => changerSalle('dragon') },
          { class: "porte2", top: "48%", left: "41%", width: "13.5%", height: "25%", action: () => changerSalle('dragon') },
          { class: "porte3", top: "54%", left: "60%", width: "10%", height: "19%", action: () => changerSalle('dragon') },
          { class: "porte4", top: "57.5%", left: "73.5%", width: "8.5%", height: "16%", action: () => changerSalle('dragon') },
          { class: "porte5", top: "60%", left: "84.5%", width: "8%", height: "14%", action: () => changerSalle('dragon') }
        ]
      },
      dragon: {
        image: "https://i.imgur.com/c6RyYT0.png",
        zones: [
          { class: "porteDragon", top: "55%", left: "32%", width: "11%", height: "20%", action: () => alert("Accès porte Dragon") }
        ]
      }
    };

    function changerSalle(nom) {
      const salle = salles[nom];
      if (!salle) return;
      const wrapper = document.querySelector('.imageWrapper');
      const mainImage = document.getElementById('mainImage');
      mainImage.src = salle.image;
      document.querySelectorAll('.zone').forEach(z => z.remove());

      salle.zones.forEach(zone => {
        const z = document.createElement('a');
        z.className = `zone ${zone.class}`;
        Object.assign(z.style, {
          top: zone.top,
          left: zone.left,
          width: zone.width,
          height: zone.height
        });
        z.addEventListener('click', zone.action);
        wrapper.appendChild(z);
      });
    }

    // Scroll auto à 63% après chargement image
    window.addEventListener('DOMContentLoaded', () => {
      const container = document.getElementById('container');
      const image = document.getElementById('mainImage');
      const tryScroll = (maxAttempts = 30, attempt = 0) => {
        if (image && container && image.naturalHeight > 0) {
          const imageHeight = image.naturalHeight * (image.clientWidth / image.naturalWidth);
          const scrollY = imageHeight * 0.63 - container.clientHeight / 2;
          container.scrollTop = scrollY;
        } else if (attempt < maxAttempts) {
          setTimeout(() => tryScroll(maxAttempts, attempt + 1), 100);
        }
      };
      if (image.complete) tryScroll();
      else image.addEventListener('load', () => tryScroll());
    });

    // Plein écran
    document.getElementById('fullscreenBtn').addEventListener('click', () => {
      if (!document.fullscreenElement) {
        document.documentElement.requestFullscreen().catch(err => alert(err));
        localStorage.setItem('forceFullscreen', 'true');
      } else {
        document.exitFullscreen();
        localStorage.setItem('forceFullscreen', 'false');
      }
    });

    // Chargement initial salle
    changerSalle('montagne');
  </script>
</body>
</html>
